<!DOCTYPE html>
<html lang="pt-br">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
    <link rel="stylesheet" href="css/style.css">
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script
      src="https://kit.fontawesome.com/89d28f01ec.js"
      crossorigin="anonymous"
    ></script>

</head>
<body>

    <div class="home">
        <div class="menu">

            <!-- HOME -->
            <div class="iconHome">
                <img src="assets/home.png" alt="">
            </div>

            <!-- DASHBOARD -->
            <div class="iconDash" onclick="irDash()">
              <img src="assets/dashboard.png" alt="">
            </div>

        </div>
        <div class="contentHome">
            <div class="registros">
                <div class="regDesp">
                    <p onclick="openDesp()">Registrar Despesa</p>
                </div>
                <div class="regEntr">
                  <p onclick="openEntr()">Registrar Entrada</p>
                </div>
            </div>

            <div class="historicos">
                <div class="histDesp">
                    <h1>Histórico de Despesas</h1>
                </div>
                <div class="histEntr">
                    <h1>Histórico de Entradas</h1>
                </div>
            </div>


    <div class="form-popup" id="myDesp">
    <form action="/action_page.php" class="form-container">
        <h1>Registrar Despesa</h1>

        <label for="title">Nome: </label>
        <input id="ipt_nomeDesp" type="text" placeholder="Nome Despesa" name="text" required>

        <label for="psw">Data: </label>
        <input id="ipt_dataDesp" type="date" placeholder="00/00/0000" name="date" required>
        <p></p>

        <label for="appt">Horário Despesa: </label>
        <input type="time" id="ipt_horaDesp" name="appt" min="09:00" max="18:00" required />
      <p></p>

        <label for="psw">Descrição: </label>
        <textarea id="ipt_descDesp" name="descr" rows="4" cols="50"></textarea>

        <button type="submit" class="btn" onclick="regDesp()">REGISTRAR</button>
        <button type="button" class="btn cancel" onclick="closeDesp()">Sair</button>
    </form>
            </div>
        </div>

        <div class="form-popup" id="myEntr">
          <form action="/action_page.php" class="form-container">
              <h1>Registrar Entrada</h1>
      
              <label for="title">Nome: </label>
              <input type="text" placeholder="Nome Entrada" name="text" required>
      
              <label for="psw">Data: </label>
              <input type="date" placeholder="00/00/0000" name="date" required>
              <p></p>
              <label for="appt">Horário Entrada: </label>
      
            <input type="time" id="appt" name="appt" min="09:00" max="18:00" required />
            <p></p>
      
              <label for="psw">Descrição: </label>
              <textarea id="desc" name="descr" rows="4" cols="50"></textarea>
      
              <button type="submit" class="btn">REGISTRAR</button>
              <button type="button" class="btn cancel" onclick="closeEntr()">Sair</button>
          </form>
                  </div>
              </div>
        
</body>
</html>

<script>

function openDesp() {
  document.getElementById("myDesp").style.display = "block";
}

function closeDesp() {
  document.getElementById("myDesp").style.display = "none";
}
function openEntr() {
  document.getElementById("myEntr").style.display = "block";
}

function closeEntr() {
  document.getElementById("myEntr").style.display = "none";
}

function irDash(){
  window.location.href = "dashboard.html";
}

function regDesp(){
  var nomeVar = ipt_nomeDesp.value;
        var dataVar = ipt_dataDesp.value;
        var horaVar = ipt_horaDesp.value;
        var descVar = ipt_descDesp.value;
        var fkUserVar = sessionStorage.ID_USUARIO;

        fetch("/despesa/registrar", {
            method: "POST",
            headers: {
                "Content-Type": "application/json"
            },
            body: JSON.stringify({
                nomeServer: nomeVar,
                dataServer: dataVar,
                horaServer: horaVar,
                descServer: descVar,
                fkUserServer: fkUserVar
            })
        }).then(function (resposta) {
            console.log("resposta: ", resposta);

            if(resposta.ok){

                alert("Despesa registrada!")
                
            }else{
                throw("Houve um erro ao tentar realizar o registro da despesa!")
            }
        }).catch(function (resposta){
            console.log(`#ERRO: ${resposta}`);
        });

        return false;
}

  </script>
    